<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1580px" height="1173px" version="1.1"><defs/><g transform="translate(0.5,0.5)"><path d="M 371 1170 L 371 8" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 551 1170 L 551 6" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 1361 1170 L 1361 1" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 761 1169 L 761 2" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><rect x="1" y="392" width="1319" height="398" rx="60" ry="60" fill="#ffffff" stroke="#007fff" pointer-events="none"/><rect x="21" y="410" width="910" height="360" rx="54" ry="54" fill="#ffffff" stroke="#007fff" pointer-events="none"/><rect x="41" y="430" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(43,453)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">HadoopRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="221" y="430" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(223,453)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="131" y="178" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="171" y="202">lines = sc.textFile(path)</text></g><rect x="411" y="178" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="451" y="195">words = lines.flatMap</text><text x="451" y="209">(x=&gt;x.split("\t"))</text></g><rect x="615" y="179" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="655" y="196">wordCounts = words.</text><text x="655" y="210">map(x=&gt;(x, 1))</text></g><rect x="1001" y="179" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1041" y="203">combine = wordCounts.reduceByKey(_ + _)</text></g><rect x="1411" y="179" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1451" y="203">combine.saveAsTextFile(path)</text></g><rect x="411" y="430" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(413,453)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">FlatMappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="601" y="430" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(603,453)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="791" y="430" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(793,453)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MapPartitionsRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1181" y="430" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(1183,453)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MapPartitionsRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1002" y="430" width="120" height="60" rx="9" ry="9" fill="#b9e0a5" stroke="#000000" pointer-events="none"/><g transform="translate(1004,453)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">SuffledRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 161 460 L 219 460" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 213 464 L 220 460 L 213 457" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 341 460 L 409 460" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 403 464 L 410 460 L 403 457" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 531 460 L 599 460" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 593 464 L 600 460 L 593 457" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 721 460 L 789 460" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 783 464 L 790 460 L 783 457" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 460 L 1000 460" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 994 464 L 1001 460 L 994 457" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1122 460 L 1179 460" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1173 464 L 1180 460 L 1173 457" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="41" y="550" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(43,573)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">HadoopRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="221" y="550" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(223,573)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="411" y="550" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(413,573)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">FlatMappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="601" y="550" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(603,573)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="791" y="550" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(793,573)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MapPartitionsRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1181" y="550" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(1183,573)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MapPartitionsRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1002" y="550" width="120" height="60" rx="9" ry="9" fill="#b9e0a5" stroke="#000000" pointer-events="none"/><g transform="translate(1004,573)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">SuffledRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 161 580 L 219 580" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 213 584 L 220 580 L 213 577" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 341 580 L 409 580" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 403 584 L 410 580 L 403 577" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 531 580 L 599 580" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 593 584 L 600 580 L 593 577" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 721 580 L 789 580" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 783 584 L 790 580 L 783 577" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 580 L 1000 580" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 994 584 L 1001 580 L 994 577" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1122 580 L 1179 580" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1173 584 L 1180 580 L 1173 577" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 580 L 1000 462" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 999 469 L 1000 461 L 993 464" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 460 L 1000 578" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 993 576 L 1000 579 L 999 571" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1443" y="510" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(1445,533)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">sc.runJob</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1320" y="505" width="80" height="70" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1360" y="544">saveAsHadoopDataset</text></g><path d="M 1301 484 L 1441 539" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1434 540 L 1442 540 L 1437 534" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1301 571 L 1441 549" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1436 554 L 1442 549 L 1434 547" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1441" y="391" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(1443,414)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">生成finalStage</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1426" y="280" width="150" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(1428,303)"><switch><foreignObject pointer-events="all" width="146" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 146px; white-space: normal; text-align: center;">submitStage(finalStage)</div></foreignObject><text x="73" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1502 510 L 1502 453" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1505 459 L 1502 452 L 1498 459" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1501 391 L 1501 342" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1505 348 L 1501 341 L 1498 348" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1086" y="280" width="150" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(1088,303)"><switch><foreignObject pointer-events="all" width="146" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 146px; white-space: normal; text-align: center;">OneToOneDependency</div></foreignObject><text x="73" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="891" y="280" width="150" height="60" rx="9" ry="9" fill="#b9e0a5" stroke="#000000" pointer-events="none"/><g transform="translate(893,303)"><switch><foreignObject pointer-events="all" width="146" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 146px; white-space: normal; text-align: center;">ShuffleDependency</div></foreignObject><text x="73" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="671" y="280" width="150" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(673,303)"><switch><foreignObject pointer-events="all" width="146" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 146px; white-space: normal; text-align: center;">OneToOneDependency</div></foreignObject><text x="73" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="456" y="280" width="150" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(458,303)"><switch><foreignObject pointer-events="all" width="146" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 146px; white-space: normal; text-align: center;">OneToOneDependency</div></foreignObject><text x="73" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="266" y="280" width="150" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(268,303)"><switch><foreignObject pointer-events="all" width="146" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 146px; white-space: normal; text-align: center;">OneToOneDependency</div></foreignObject><text x="73" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1221 430 L 1161 340" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1136 340 L 1063 428" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1064 422 L 1063 429 L 1070 426" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="1078" y="379" width="44" height="15" stroke-width="0"/><text x="1099" y="389">dep.rdd</text></g><path d="M 1043 430 L 985 340" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 943 340 L 875 428" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 876 421 L 875 429 L 882 426" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 830 430 L 767 340" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 729 340 L 679 428" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 679 421 L 679 429 L 685 425" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 635 430 L 557 340" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 519 340 L 484 428" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 483 421 L 483 429 L 489 424" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 445 430 L 367 340" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 329 340 L 294 428" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 293 421 L 293 429 L 299 424" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="71" y="280" width="150" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(73,303)"><switch><foreignObject pointer-events="all" width="146" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 146px; white-space: normal; text-align: center;">OneToOneDependency</div></foreignObject><text x="73" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 254 430 L 173 340" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 137 340 L 111 428" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 109 421 L 110 429 L 116 423" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1426 310 L 1238 310" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 1244 307 L 1237 310 L 1244 314" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="11px"><rect fill="#ffffff" stroke="none" x="1319" y="304" width="25" height="15" stroke-width="0"/><text x="1331" y="314">Visit</text></g><path d="M 1086 310 L 1043 310" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 1049 307 L 1042 310 L 1049 314" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 891 310 L 823 310" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 829 307 L 822 310 L 829 314" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 671 310 L 608 310" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 614 307 L 607 310 L 614 314" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 456 310 L 418 310" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 424 307 L 417 310 L 424 314" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 266 310 L 223 310" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 229 307 L 222 310 L 229 314" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1418" y="849" width="160" height="110" rx="17" ry="17" fill="#ffcc99" stroke="#000000" pointer-events="none"/><g transform="translate(1420,852)"><switch><foreignObject pointer-events="all" width="156" height="105" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 156px; white-space: normal; text-align: center;">ResultTask<br />stage1产生的Task<br />调用rdd的iterator()方法获得相应的Iterator. 执行action时的参数func:  func(Iterator)。该func中主要是遍历Iterator进行相关操作</div></foreignObject><text x="78" y="59" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1178" y="862" width="130" height="80" rx="12" ry="12" fill="#ffe599" stroke="#000000" pointer-events="none"/><g transform="translate(1180,872)"><switch><foreignObject pointer-events="all" width="126" height="60" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 126px; white-space: normal; text-align: center;">compute:<br />f(firstParent.iterator())<br />每个compute产生的结果都是Iterator</div></foreignObject><text x="63" y="36" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="213" y="862" width="130" height="80" rx="12" ry="12" fill="#ffe599" stroke="#000000" pointer-events="none"/><g transform="translate(215,880)"><switch><foreignObject pointer-events="all" width="126" height="45" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 126px; white-space: normal; text-align: center;">compute:<br />firstParent.iterator()<br />.map()</div></foreignObject><text x="63" y="29" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="403" y="862" width="130" height="80" rx="12" ry="12" fill="#ffe599" stroke="#000000" pointer-events="none"/><g transform="translate(405,880)"><switch><foreignObject pointer-events="all" width="126" height="45" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 126px; white-space: normal; text-align: center;">compute:<br />firstParent.iterator()<br />.flatMap()</div></foreignObject><text x="63" y="29" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="592" y="862" width="130" height="80" rx="12" ry="12" fill="#ffe599" stroke="#000000" pointer-events="none"/><g transform="translate(594,880)"><switch><foreignObject pointer-events="all" width="126" height="45" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 126px; white-space: normal; text-align: center;">compute:<br />firstParent.iterator()<br />.map()</div></foreignObject><text x="63" y="29" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="788" y="862" width="130" height="80" rx="12" ry="12" fill="#ffe599" stroke="#000000" pointer-events="none"/><g transform="translate(790,887)"><switch><foreignObject pointer-events="all" width="126" height="30" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 126px; white-space: normal; text-align: center;">compute:<br />f(firstParent.iterator())</div></foreignObject><text x="63" y="21" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="994" y="862" width="130" height="80" rx="12" ry="12" fill="#ffe599" stroke="#000000" pointer-events="none"/><g transform="translate(996,865)"><switch><foreignObject pointer-events="all" width="126" height="75" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 126px; white-space: normal; text-align: center;">compute:<br />调用shuffleFetcher获得ShuffleMapTask产生的数据，结果是Iterator型的<br /></div></foreignObject><text x="63" y="44" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="13" y="862" width="150" height="80" rx="12" ry="12" fill="#ffe599" stroke="#000000" pointer-events="none"/><g transform="translate(15,865)"><switch><foreignObject pointer-events="all" width="146" height="75" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 146px; white-space: normal; text-align: center;">compute:<br />生成Iterator对象，主要是hasNext和next方法，next方法是通过RecordReader获得hdfs上的数据</div></foreignObject><text x="73" y="44" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1418 903 L 1314 903" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1309 903 L 1316 899 L 1314 903 L 1316 906 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1178 902 L 1130 902" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1125 902 L 1132 899 L 1130 902 L 1132 906 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 788 902 L 728 902" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 723 902 L 730 899 L 728 902 L 730 906 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 592 902 L 539 902" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 534 902 L 541 899 L 539 902 L 541 906 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 403 902 L 349 902" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 344 902 L 351 899 L 349 902 L 351 906 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 213 902 L 169 902" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 164 902 L 171 899 L 169 902 L 171 906 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="1322" y="850" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1362" y="867">iterator方法中主体是</text><text x="1362" y="881">compute方法</text></g><rect x="773" y="1042" width="160" height="100" rx="15" ry="15" fill="#ffcc99" stroke="#000000" pointer-events="none"/><g transform="translate(775,1047)"><switch><foreignObject pointer-events="all" width="156" height="90" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 156px; white-space: normal; text-align: center;">ShuffleMapTask<br />stage2产生的Task<br />调用rdd的iterator()方法。得到Iterator后遍历，对每一项的key根据如hash来写到bucket中</div></foreignObject><text x="78" y="51" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 853 1042 L 853 948" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 853 943 L 857 950 L 853 948 L 850 950 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 994 1050 L 1173 1050 L 1203 1080 L 1203 1130 L 994 1130 L 994 1050 Z" fill="#b9e0a5" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1173 1050 L 1173 1080 L 1203 1080" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(996,1075)"><switch><foreignObject pointer-events="all" width="205" height="30" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 205px; white-space: normal;">map:ShuffleMapTask<br />reduce:触发Shffule的RDD的compute</div></foreignObject><text x="103" y="21" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1090 1050 L 1067 942" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 994 1091 L 933 1091" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><rect x="41" y="680" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(43,703)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">HadoopRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="221" y="680" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(223,703)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="411" y="680" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(413,703)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">FlatMappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="601" y="680" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(603,703)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MappedRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="791" y="680" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(793,703)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MapPartitionsRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1181" y="680" width="120" height="60" rx="9" ry="9" fill="#cce5ff" stroke="#000000" pointer-events="none"/><g transform="translate(1183,703)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">MapPartitionsRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="1002" y="680" width="120" height="60" rx="9" ry="9" fill="#b9e0a5" stroke="#000000" pointer-events="none"/><g transform="translate(1004,703)"><switch><foreignObject pointer-events="all" width="116" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.26; vertical-align: top; width: 116px; white-space: normal; text-align: center;">SuffledRDD</div></foreignObject><text x="58" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 161 710 L 219 710" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 213 714 L 220 710 L 213 707" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 341 710 L 409 710" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 403 714 L 410 710 L 403 707" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 531 710 L 599 710" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 593 714 L 600 710 L 593 707" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 721 710 L 789 710" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 783 714 L 790 710 L 783 707" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 710 L 1000 710" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 994 714 L 1001 710 L 994 707" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1122 710 L 1179 710" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1173 714 L 1180 710 L 1173 707" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 710 L 1000 582" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 999 589 L 1000 581 L 994 585" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 580 L 1000 708" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 994 705 L 1000 709 L 999 701" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 460 L 1000 708" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 995 704 L 1001 709 L 1002 701" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 710 L 1000 462" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1002 469 L 1001 461 L 995 466" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1281 680 L 1439 561" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1437 568 L 1440 561 L 1432 562" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="733" y="730" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="773" y="754">stage2</text></g><rect x="1203" y="750" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="1243" y="774">finalStage/stage1</text></g></g></svg>